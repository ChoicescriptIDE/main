const http = require('http');
const static = require('node-static');
var port;
var staticServer;
var dir;

const server = http.createServer((req, res) => {
    staticServer.serve(req, res);
}).listen(0, () => port = server.address().port);

function setStaticServeDir(dir) {
    staticServer = new(static.Server)(dir, { cache: false, indexFile: "run_index.html" });
}

module.exports =  {
    getPort: () => {
        return port;
    },
    getAddr: () => {
        return "http://127.0.0.1:" + port + "/";
    },
    getDir: () => {
        return dir;
    },
    setDir: (dir) => {
        setStaticServeDir(dir);
    }
}
